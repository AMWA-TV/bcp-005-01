# AMWA BCP-XXX-YY: EDID to NMOS Receiver Caps Mapping \[Work In Progress\]

## Background

EDID is a metadata format to describe sink devices capabilities to a video source. AMWA BCP-004-01 proposes an approach for a similar purpose in terms of IS-04 Receivers. The goal of this BCP is proposing a mapping scheme of EDID fields to Receiver Caps in order to have a specified way for representing EDID sink devices through associated IS-04 Receivers.

## Scope

This document is targeted against [E-EDID A2](#edid-ref) which consists of EDID 1.4 which is called Base EDID and optional CTA-861-G Extension Block.

## Use of Normative Language

The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this document are to be interpreted as described in [RFC 2119](#rfc2119-ref).

## Definitions

_See also the [NMOS Glossary](https://github.com/AMWA-TV/nmos/wiki/Glossary), and definitions within RFCs._

### EDID
### Receiver Caps
### Sink/Destination
### Gateway Device

## Video Receivers

If an IS-04 Video Receiver is associated with a Sink which has EDID, its video capabilities MUST be mapped into Receiver's Receiver Capabilities accordingly to the rules below.

If a Sink acts as a Gateway Device, it's supposed to expose its own EDID instead of EDID of an HDMI physical device to take in order any media transformations which the Sink performs.

### Video timings

Video timings described in E-EDID provide information about frame size, frame rate and scan type. Each video timing MUST be present as a Constraint Set in Receiver Capabilities with `urn:x-nmos:cap:format:frame_width`, `urn:x-nmos:cap:format:frame_height`, `urn:x-nmos:cap:format:grain_rate`, `urn:x-nmos:cap:format:interlace_mode` fields filled in.

#### 18 Byte Descriptors (Detailed Timing Modes)

Horizontal Addressable Video in pixels
Vertical Addressable Video in lines
Refresh rate euristic
Scan mode euristic

#### 3 Byte CVT Codes

Maximum active pixels per line
Aspect Ratio
Vertical refresh rate

#### Standard Timings

Active Horizontal Pixels, Aspect Ratio and Refresh Rate. All are non-interlaced.

#### Video Data Block

It contains VICs and there's a table with mapping between VIC and set of active horizontal and vertical pixels, vertical refresh rate and scan type.

### Color subsampling

If EDID doesn't have CTA-861 Extension Block, color subsampling formats MUST be taken from Base EDID, otherwise from the Extenstion Block.

#### Base EDID

The origin of supported color subsampling formats in Base EDID is the Feature Support byte of Base EDID (Section 3.6.4 of [E-EDID A2](#edid-ref)).

It has one of four possible values:
* RGB 4:4:4
* RGB 4:4:4 & YCbCr 4:4:4
* RGB 4:4:4 & YCbCr 4:2:2
* RGB 4:4:4 & YCbCr 4:4:4 & YCbCr 4:2:2

This value MUST be transformed into `urn:x-nmos:cap:format:color_sampling` with `enum` type value and added to each Constraint Set.

#### CTA-861 Extension Block

The origin of supported color subsampling formats in CTA-861 is CTA Extension Header (see Section 7.5 of CTA-861-G). Byte 3, bits 4 and 5 show whether Sink supports YCbCr 4:2:2 and YCbCr 4:4:4 respectively in addition to RGB.

Also, it has YCbCr 4:2:0 Video Data Block (see Section 7.5.11 of CTA-861-G), which marks timings as supporting only YCbCr 4:2:0, and YCbCr 4:2:0 Capability Map Data Block which shows whether it's supported in addition to subsampling formats listed in CTA Extension Header.

### Preference order

The basic preference order is described in Section 5 of [E-EDID A2](#edid-ref).

If CTA-861 Extension Block is present and contains Video Format Preference Data Block (see Section 7.5.12 of CTA-861-G), it MUST be used instead.

## Audio Receivers \[Work In Progress\]
             
## Normative References

<a id="nmos-cap-ref"></a>
[NMOS-CAP-REG]  "NMOS Capabilities Registry Parameters",2021, <https://github.com/AMWA-TV/nmos-parameter-registers/tree/capabilities/capabilities>.

<a id="is-edid-cm-ref"></a>
[IS-EDID-CM]  "EDID Device Control", March 2021,<https://specs.amwa.tv/nmos-edid-connection-management/branches/publish-tentative-raml/APIs/IPMXAPI.html>.

<a id="rfc2119-ref"></a>
[RFC2119]  Bradner, S., "Key words for use in RFCs to Indicate Requirement Levels", BCP 14, RFC 2119, DOI 10.17487/RFC2119, March 1997, <https://tools.ietf.org/html/bcp14>.

<a id="bcp-004-01-ref"></a>
[BCP-004-01] "NMOS Receiver Capabilities Best Current Practices"  BCP-004-01,<https://specs.amwa.tv/bcp-004-01/>.

<a id="edid-ref"></a>
[E-EDID] "VESA Enhanced Extended Display Identification Data Standard Release A, Revision 2", Available from VESA, <https://vesa.org/vesa-standards/>.

<a id="cta-861-ref"></a>
[CTA-861] "A DTV Profile for Uncompressed High Speed Digital Interfaces (CTA-861-G)", Available from CTA, <https://shop.cta.tech/products/a-dtv-profile-for-uncompressed-high-speed-digital-interfaces-cta-861-g>.

<a id="is-04-ref"></a>
[IS-04] "AMWA IS-04 NMOS Discovery and Registration Specification", <https://specs.amwa.tv/is-04/>.

<a id="is-05-ref"></a>
[IS-05] "AMWA IS-05 NMOS Device Connection Management Specification", <https://specs.amwa.tv/is-05/>.
